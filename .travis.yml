language: node_js

services:
  - docker

node_js:
  - "lts/*"
cache:
  directories:
    - "$HOME/.npm"
jobs:
  fast_finish: true
  include:
    - stage: backend
        install:
          - cd ./backend
          - npm ci
    - stage: frontend
        install:
          - cd ./frontend
          - npm ci
    - stage: Lint backend
        install:
          - cd ./backend
          - npm ci
        script:
          - npm run lint
    - stage: Test backend
      install: 
        - cd ./backend
        - docker run --rm -p 27017:27017 -d mongo
        - npm ci
      script:
        - npm run test